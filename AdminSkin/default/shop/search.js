var _LT_LocalSearchUrl=((location.protocol=="https:")?"https:":"http:")+"//srv.api.51ditu.com/apisrv/ls?";if(!window.LTEvent||!(document.all?(document.readyState!="loading"&&document.readyState!="interactive"):(window.LTEvent.readyState=="complete"))){document.writeln('<script language="javascript" src="http://mapimage1.koubei.com/mapjs/js/ajax.js"></script>');};function LTNS(){LTNS.info={time:'Fri Sep 7 09:15:36 UTC+0800 2007',version:'1',ov:'1.3 Ver 20070705'};var w=function(h){var j=0,k=0;var l=h.length;var z=new String();var x=-1;var c=0;for(var v=0;v<l;v++){var b=h.charCodeAt(v);b=(b==95)?63:((b==44)?62:((b>=97)?(b-61):((b>=65)?(b-55):(b-48))));k=(k<<6)+b;j+=6;while(j>=8){var n=k>>(j-8);if(c>0){x=(x<<6)+(n&(0x3f));c--;if(c==0){z+=String.fromCharCode(x);};}else{if(n>=224){x=n&(0xf);c=2;}else if(n>=128){x=n&(0x1f);c=1;}else{z+=String.fromCharCode(n);};};k=k-(n<<(j-8));j-=8;};};return z;};var q=["Error","Code","Center",',','area=RECT(',')',' ','area=POINT(',""];var i=window;var o=document;function g(h,j){for(var k in j){h[k]=j[k];};}function a(g){var e=this;e.handle=g;e.modea=0;e.mode=0;e.areaNum=1;e.showName=1;e.sortType=0;e.pagecap=10;e.radius=5000;e.class1=-1;e.class2=-1;e.district1=-1;e.district2=-1;e.totalNumber=-1;};g(a.prototype,{searchBase:function(){var e=this;if(!e.city||e.city==q[8]||!e.words||e.words==q[8]){return;};var g=[];if(e.city){g.push('city='+encodeURI(e.city));};if(e.area){if(typeof(e.area)=="string"){g.push('area='+encodeURI(e.area));};if(typeof(e.area)=="object"){if(e.area.getLongitude){g.push(q[7]+e.area.getLongitude()+q[6]+e.area.getLatitude()+q[5]);}else if(e.area.getXmin){g.push(q[4]+e.area.getXmin()+q[6]+e.area.getYmax()+q[3]+e.area.getXmax()+q[6]+e.area.getYmin()+q[5]);}else if(e.area.length==4){g.push(q[4]+e.area[0]+q[6]+e.area[3]+q[3]+e.area[2]+q[6]+e.area[1]+q[5]);}else if(e.area.length==2){g.push(q[7]+e.area[0]+q[6]+e.area[1]+q[5]);};};};if(e.words){g.push('words='+encodeURI(e.words));};if(e.modea==1){g.push('modea='+parseInt(e.modea));};if(e.mode==1){g.push('mode='+parseInt(e.mode));};if(e.areaNum>0&&e.areaNum<=10){g.push('areaNum='+parseInt(e.areaNum));};if(e.showName==1){g.push('showName='+parseInt(e.showName));};if(e.sortType>0){g.push('sortType='+parseInt(e.sortType));};if(e.start>1){g.push('start='+parseInt(e.start));};if(e.pagecap>0&&e.pagecap<=100){g.push('pagecap='+parseInt(e.pagecap));};if(e.radius>0){g.push('radius='+parseInt(e.radius));};if(e.class1!=-1&&e.class2!=-1){g.push('class1='+e.class1);g.push('class2='+e.class2);};if(e.district1!=-1&&e.district2!=-1){g.push('district1='+e.district1);g.push('district2='+e.district2);};var h=LTObjectLoader.getObject();h.loadListener=LTEvent.bind(h,"loaded",e,e.onResult);h.load(i._LT_LocalSearchUrl+g.join('&'));LTEvent.trigger(e,"loadstart");},search:function(g,h,j){var e=this;e.area=h;e.words=g;e.start=(j&&j>0)?parseInt(j):1;e.totalNumber=-1;e.searchBase();},setCity:function(g){var e=this;if(i.LTPlaceList){var h=i.LTPlaceList.getDefault();var j=h.search(function(k){k.getName()==g},1);if(j.length<1){j=h.searchPlace(g,1);if(j.length>0){g=j[0].getName();};};};e.city=g;},getTotalNumber:function(){var e=this;return e.totalNumber;},getTotalPage:function(){var e=this;return e.totalPage;},searchPage:function(g){var e=this;if(e.totalPage<=0||g<=0||g>e.totalPage){return false;};e.start=g;e.searchBase();return true;},searchRadius:function(g){var e=this;e.radius=g;e.start=1;e.searchBase();return true;},firstPage:function(){var e=this;return e.searchPage(1);},nextPage:function(){var e=this;return e.searchPage(e.start+1);},previousPage:function(){var e=this;return e.searchPage(e.start-1);},lastPage:function(){var e=this;return e.searchPage(e.totalPage);},onResult:function(g){var e=this;e.running=false;var h=new d();h.page=e.start;h.time=g.a.time;h.error=parseInt(g.a.error);switch(h.error){case 0:if(g.c[0]&&g.c[0].n==q[2]){var j=g.c[0].c;for(var k=0;k<j.length;k++){h.centerPoints.push(s(j[k]));};};var l=LTObjectLoader.getChild(g,"PoiRes");if(l){if(l.a.total){e.totalNumber=parseInt(l.a.total);e.totalPage=Math.ceil(e.totalNumber/e.pagecap);};for(var k=0;k<l.c.length;k++){h.addSearchPoint(s(l.c[k]));};};break;case 1:h.errorCode=LTObjectLoader.getChild(g,q[1]);h.errorDescription=LTObjectLoader.getChild(g,q[0]);break;case 2:var z=LTObjectLoader.getChild(g,q[2]);h.errorCode=LTObjectLoader.getChild(z,q[1]);h.errorDescription=LTObjectLoader.getChild(z,q[0]);case 3:var x=LTObjectLoader.getChild(g,"Word");h.errorCode=LTObjectLoader.getChild(x,q[1]);h.errorDescription=LTObjectLoader.getChild(x,q[0]);default:};if(e.handle){e.handle.apply(null,[h]);};LTEvent.trigger(e,"loadend",[h]);}});function s(g){var h,j;h=LTObjectLoader.getChild(g,"Geo");if(h){j=[parseInt(h.a.lo),parseInt(h.a.la)];};var k=new f(j);k.id=g.a.id;h=LTObjectLoader.getChild(g,"Na");if(h){k.name=h.a.v;};h=LTObjectLoader.getChild(g,"LSID");if(h){var l=h.a.v;k.url=w("Q7HqS3elBtTtTourCMHfT7KkOszjBt0_QMGz")+l.substring(l.lastIndexOf("/")+1);};h=LTObjectLoader.getChild(g,"Add");if(h){k.address=h.a.v;};h=LTObjectLoader.getChild(g,"Tel");if(h){k.telephone=h.a.v;};h=LTObjectLoader.getChild(g,"Admin");if(h){k.admin=h.a;};h=LTObjectLoader.getChild(g,"Class");if(h){k.cla=h.a;};return k;};g(a,{getSearchPoint:s});function d(){var e=this;e.time=-1;e.error=0;e.count=0;e.searchPoints=[];e.centerPoints=[];};g(d.prototype,{getPageIndex:function(){var e=this;return e.page;},addSearchPoint:function(g){var e=this;e.searchPoints.push(g);e.count++;},getSearchPointsNumber:function(){var e=this;return e.count;}});function f(g){var e=this;if(g.getLongitude){e.point=[g.getLongitude(),g.getLatitude()];}else{e.point=g;};};var p=function(a){return(location.protocol=="file:"||new RegExp(a,"i").test(location.href))};if(!p(w("NbnpAYXeT7HmA3ywSoa_EYylAJyeFpfRN7TTArmkAIeeFpeeFpfhRtLYPMbSBcDlRIbyA3ywUM5eRszSBcDlRIbyA3ywUM5eRszSBcDkAIa")))return false;g(i,{LTLocalSearch:a,LTLocalSearchResult:d,LTLocalSearchPoint:f})};LTNS();
